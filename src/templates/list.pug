//pre= JSON.stringify(listableFields, null, 2)
section#list
  div.pull-right
    a.btn.btn-primary.btn-create.ng-hide(
      ui-sref=schema.states.create
      ng-show=`$root.Auth.hasPermissions('${schema.permissions.create}')`
      )
      i.fa.fa-plus.fa-lg
      span(translate="")= schema.getButton('list_create').text

  div.clearfix

  //pre {{list | json}}

  table.table.table-striped(st-table='' id=name st-pipe="getList")
    thead
      tr.headers
        each control in listableFields
          th(st-sort=control.name translate="")
            span= control.frontField.label || control.backField.label
        th(translate="") Actions
      tr.filters
        each control in listableFields
          if (control.frontField.type)
            th
              if (control.frontField.type == "text" || control.frontField.type == "static" || control.frontField.type == "email")
                input.input-sm.form-control(st-search=control.searchModel type="text" id=control.id)
              if (control.frontField.type == "number")
                input.input-sm.form-control(st-search=control.searchModel type="number" id=control.id)
              if (control.frontField.type == "date-range")
                st-date-range(collection=control.label_values predicate=control.searchModel id=control.id)
              if (control.label_values)
                st-select(collection=control.label_values predicate=control.searchModel id=control.id)
          else
            th
        th
    tbody
      tr(ng-repeat='row in list.list')
        each control in listableFields
          td= '{{row.' + control.realpath + (control.label_filter ? ' | ' + control.label_filter : '') + '}}'
        td
          a.entity-action.entity-update.ng-hide(
            ui-sref=`^.update({ ${schema.apiIdParam} : row._id })`
            uib-tooltip=`{{'${schema.getButton('update').tooltip}' | translate}}`
            ng-show=`$root.Auth.hasPermissions('${schema.permissions.update}')`
          )
            i.fa.fa-pencil-square-o.fa-lg
          a.entity-action.entity-delete.ng-hide(
            ng-click='delete($index, row)'
            confirm=`{{'${schema.getButton('delete').alert}' | translate}}`
            uib-tooltip=`{{'${schema.getButton('delete').tooltip}' | translate}}`
            ng-show=`$root.Auth.hasPermissions('${schema.permissions.delete}')`
          )
            i.fa.list.fa-trash-o.fa-lg
    tfoot
      tr
        //td.text-center(st-pagination='', st-items-by-page='list.limit', colspan=columns)
        td(colspan=columns + 1)
          span(st-pagination="", st-items-by-page="list.limit")
          span.btn.btn-secondary(ng-click="download('text/csv')")
            i.fa.fa-download
            span Descargar SCV
          span.btn.btn-secondary(ng-click="download('text/xml')")
            i.fa.fa-download
            span Descargar XML
          span.btn.btn-secondary
            i.fa.fa-download
            span Descargar EXCEL-XML
