<form #form="ngForm" *ngIf="test">
  <!-- <pre>{{test |json}}</pre> -->
  <!-- <pre>{{test.blocks[currentBlock].questions[currentQuestion] |json}}</pre> -->
  <!-- <pre>{{answers |json}}</pre> -->

  <div class="d-flex">
    <div class="ml-auto">Tiempo restante: {{countDown()}}</div>
  </div>

  <h1>{{test.label}} ({{currentQuestion + 1}} / {{maxQuestion}})</h1>
  <h2>{{test.blocks[currentBlock].questions[currentQuestion].questionLabel}}</h2>
  <ul class="list-unstyled">
    <li *ngFor="let answer of test.blocks[currentBlock].questions[currentQuestion].answers; let i = index;">

    <bb-radio
      name="answer"
      [(ngModel)]="answers[currentQuestion]"
      required="required"
      [value]="i">
        <strong>{{answerIndexes[i]}}</strong>: {{answer.answerLabel}}
      </bb-radio>

    </li>
  </ul>

  <div class="row">
    <bb-button
      (click)="prev()"
      *ngIf="currentQuestion > 0">Pregunta anterior</bb-button>

    <bb-button
      class="ml-auto"
      (click)="next()"
      *ngIf="currentQuestion + 1 < maxQuestion"
      [disabled]="!form.valid">Pregunta siguiente</bb-button>

    <bb-button
      btn="warning"
      class="ml-auto"
      (click)="finish(true, false)"
      *ngIf="currentQuestion + 1 == maxQuestion"
      [disabled]="!form.valid">Entregar examen</bb-button>
  </div>


</form>


<bb-modal
  header="Entregar examen"
  size="lg"
  #finishExamModal>
  <bb-section-content>
    <p>¿Está seguro de entregar el exámen?</p>
    <p>Un examen entregado no puede ser modificado.</p>
  </bb-section-content>
  <bb-section-footer>
    <div class="d-flex">
      <bb-button (click)="finishExamModal.hide()">Volver</bb-button>
      <bb-button btn="warning" class="ml-auto"(click)="finish(true, true)">Entregar examen</bb-button>
    </div>
  </bb-section-footer>
</bb-modal>

<bb-modal
  header="Tiempo de examen agotado"
  size="lg"
  #timeExpiredModal>
  <bb-section-content>
    <p>El tiempo máximo de exámen se ha superado, el examen ha sido entregado automáticamente</p>
  </bb-section-content>
  <bb-section-footer>
    <div class="d-flex">
      <bb-button btn="warning" class="ml-auto"(click)="exit()">Ok</bb-button>
    </div>
  </bb-section-footer>
</bb-modal>
